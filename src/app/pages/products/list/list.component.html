<div class="mt-3 mb-3 d-grid gap-2 d-md-flex justify-content-md-end">
    <!--button type="button" class="btn btn-success" [routerLink]="['/productsNew']">Nuevo</button-->
    <button type="button" class="btn btn-success" (click)="addingNewProduct()">
        Agregar <i class="fas fa-plus-circle"></i>
    </button>
</div>

<div class="p-3 bg-light border border-2 rounded rounded-3" *ngIf="addingNew">
    <div class="text-center">
        <h5>Formulario de Nuevo Producto</h5>
    </div>
    <form class="mt-3 col" (ngSubmit)="onSave()" [formGroup]="productForm">

        <div class="row mt-2">
            <div class="form-group col-md">
                <label for="">Tipo de Producto:</label>
                <input type="text" class="form-control" placeholder="" 
                        formControlName="prodType" [class]="isValidField('prodType')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('prodType').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>
                                
            <div class="form-group col-md-6">
                <label for="">Nombre del Producto:</label>
                <input type="text" class="form-control" placeholder="" 
                        formControlName="name" [class]="isValidField('name')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('name').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>

            <div class="form-group col-md">
                <label for="">Envase:</label>
                <input type="text" class="form-control" placeholder="" 
                        formControlName="unit" [class]="isValidField('unit')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('unit').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>

        </div>

        <div class="row mt-2">
            
            <div class="form-group col-md">
                <label for="">Unidades:</label>
                <input type="number" class="form-control" placeholder="" 
                        formControlName="singleQuant" [class]="isValidField('singleQuant')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('singleQuant').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>
            
            <div class="form-group col-md">
                <label for="">Cajas:</label>
                <input type="number" class="form-control" placeholder="" 
                        formControlName="boxQuant" [class]="isValidField('boxQuant')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('boxQuant').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>
                    
            <div class="form-group col-md">
                <label for="">Precio Unitario:</label>
                <input type="number" class="form-control" placeholder="" 
                        formControlName="price" [class]="isValidField('price')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('price').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>

            <div class="form-group col-md">
                <label for="">Precio por Mayor:</label>
                <input type="number" class="form-control" placeholder="" 
                        formControlName="boxPrice" [class]="isValidField('boxPrice')">
                <div class="invalid-feedback">
                    <span *ngIf="productForm.get('boxPrice').errors?.required">
                        Este campo es requerido.
                    </span>
                </div>
            </div>
            
        </div>
    
        <div class="row mt-3">
            <div class="container btn-group col-md-6">
                <button type="submit" class="btn btn-outline-primary">
                    Guardar <i class="far fa-save"></i>
                </button>
                <button type="" class="btn btn-outline-danger" (click)="addingNewProduct()">
                    Cancelar <i class="far fa-window-close"></i>
                </button>
            </div>
        </div>
    
    </form>
    
</div>

<div class="mt-5 mb-2 text-center">
    <h3>Lista de Productos</h3>
</div>

<table class="table table-sm mt-4">
    <div class="table-responsive">
        <table class="table align-middle table-hover table-striped">
            <thead class="table-light">
                <tr>
                    <th scope="col">Tipo</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">envase</th>
                    <th scope="col">uds.</th>
                    <th scope="col">cajas</th>
                    <th scope="col">P. ud.</th>
                    <th scope="col">P. may.</th>
                    <th scope="col">Opciones</th>
                </tr>
                </thead>
            <tbody>
                <tr class="table-light" *ngFor="let product of products | async">
                    <td scope="row">{{product.prodType}}</td>
                    <td>{{product.name}}</td>
                    <td>{{product.unit}}</td>
                    <td>{{product.singleQuant}}</td>
                    <td>{{product.boxQuant}}</td>
                    <td>S/. {{product.price}}</td>
                    <td>S/. {{product.boxPrice}}</td>
                    <td>
                        <div class="btn-group btn-group-sm" role="group" >
                            
                            <button type="button" class="btn btn-outline-primary" (click)="onDetails(product)">
                                <i class="fas fa-eye"></i>
                            </button>

                            <button mat-flat-button type="button" class="btn btn-outline-danger" (click)="onDelete(product.id)">
                                <i class="fas fa-trash"></i>
                            </button>
                            
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    
</table>
